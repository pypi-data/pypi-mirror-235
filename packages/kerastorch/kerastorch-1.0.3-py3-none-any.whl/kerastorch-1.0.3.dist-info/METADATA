Metadata-Version: 2.1
Name: kerastorch
Version: 1.0.3
Summary: llm model process for pytorch
Home-page: 
Author: kerastorch team
Author-email: 1027763372@qq.com
License: BSD License
Keywords: machine-learning,deep-learning,ML,DL,pytorch,torch,llm
Platform: all
Classifier: Intended Audience :: Developers
Classifier: Operating System :: OS Independent
Classifier: Natural Language :: Chinese (Simplified)
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 2.7
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.5
Classifier: Programming Language :: Python :: 3.6
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Topic :: Software Development :: Libraries
Description-Content-Type: text/markdown
License-File: LICENSE.txt
Requires-Dist: accelerate (>=0.20.3)
Requires-Dist: tqdm

kerastorch æ˜¯ä¸€ä¸ªé€šç”¨çš„pytorchæ¨¡å‹è®­ç»ƒæ¨¡ç‰ˆå·¥å…·ï¼Œä½ å¯ä»¥åƒä½¿ç”¨kerasä¸€æ ·ï¼Œä½¿ç”¨pytorch,å®ƒå…·æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š

* **å¥½çœ‹** (ä»£ç ä¼˜é›…ï¼Œæ—¥å¿—ç¾ä¸½ï¼Œè‡ªå¸¦å¯è§†åŒ–)

* **å¥½ç”¨** (ä½¿ç”¨æ–¹ä¾¿ï¼Œæ”¯æŒ è¿›åº¦æ¡ã€è¯„ä¼°æŒ‡æ ‡ã€early-stoppingç­‰å¸¸ç”¨åŠŸèƒ½ï¼Œæ”¯æŒtensorboardï¼Œwandbå›è°ƒå‡½æ•°ç­‰æ‰©å±•åŠŸèƒ½)

* **å¥½æ”¹** (ä¿®æ”¹ç®€å•ï¼Œæ ¸å¿ƒä»£ç æ¨¡å—åŒ–ï¼Œä»…çº¦200è¡Œï¼Œå¹¶æä¾›ä¸°å¯Œçš„ä¿®æ”¹ä½¿ç”¨æ¡ˆä¾‹)



## ä½¿ç”¨æ–¹æ³• ğŸŠğŸŠ


å®‰è£… kerastorch
```
pip install kerastorch
```

é€šè¿‡ä½¿ç”¨kerastorchï¼Œä½ ä¸éœ€è¦å†™è‡ªå·±çš„pytorchæ¨¡å‹è®­ç»ƒå¾ªç¯ã€‚ä½ åªè¦åšè¿™æ ·ä¸¤æ­¥å°±å¯ä»¥äº†ã€‚

(1) åˆ›å»ºä½ çš„æ¨¡å‹ç»“æ„net,ç„¶åæŠŠå®ƒå’ŒæŸå¤±å‡½æ•°ä¼ å…¥kerastorch.KerasModelæ„å»ºä¸€ä¸ªmodelã€‚

(2) ä½¿ç”¨modelçš„fitæ–¹æ³•åœ¨ä½ çš„è®­ç»ƒæ•°æ®å’ŒéªŒè¯æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼Œè®­ç»ƒæ•°æ®å’ŒéªŒè¯æ•°æ®éœ€è¦å°è£…æˆä¸¤ä¸ªDataLoader.



æ ¸å¿ƒä½¿ç”¨ä»£ç å°±åƒä¸‹é¢è¿™æ ·ï¼š

```python
import torch 
import kerastorch
import torchmetrics
model = kerastorch.KerasModel(net,
                              loss_fn = nn.BCEWithLogitsLoss(),
                              optimizer= torch.optim.Adam(net.parameters(),lr = 1e-4),
                              metrics_dict = {"acc":torchmetrics.Accuracy(task='binary')}
                             )
dfhistory=model.fit(train_data=dl_train, 
                    val_data=dl_val, 
                    epochs=20, 
                    patience=3, 
                    ckpt_path='checkpoint.pt',
                    monitor="val_acc",
                    mode="max",
                    plot=True,
                    
                   )

```

åœ¨jupyter notebookä¸­æ‰§è¡Œè®­ç»ƒä»£ç ï¼Œä½ å°†çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è®­ç»ƒå¯è§†åŒ–å›¾åƒå’Œè®­ç»ƒæ—¥å¿—è¿›åº¦æ¡ã€‚

![](./data/kerastorch_plot.gif)




## ä¸»è¦ç‰¹æ€§ ğŸ‰ğŸ‰


kerastorch æ”¯æŒä»¥ä¸‹è¿™äº›åŠŸèƒ½ç‰¹æ€§ï¼Œç¨³å®šæ”¯æŒè¿™äº›åŠŸèƒ½çš„èµ·å§‹ç‰ˆæœ¬ä»¥åŠè¿™äº›åŠŸèƒ½å€Ÿé‰´æˆ–è€…ä¾èµ–çš„åº“çš„æ¥æºè§ä¸‹è¡¨ã€‚


|åŠŸèƒ½| ç¨³å®šæ”¯æŒèµ·å§‹ç‰ˆæœ¬ | ä¾èµ–æˆ–å€Ÿé‰´åº“ |
|:----|:-------------------:|:--------------|
|âœ… è®­ç»ƒè¿›åº¦æ¡ | 3.0.0   | ä¾èµ–tqdm,å€Ÿé‰´keras|
|âœ… è®­ç»ƒè¯„ä¼°æŒ‡æ ‡  | 3.0.0   | å€Ÿé‰´pytorch_lightning |
|âœ… notebookä¸­è®­ç»ƒè‡ªå¸¦å¯è§†åŒ– |  3.8.0  |å€Ÿé‰´fastai |
|âœ… early stopping | 3.0.0   | å€Ÿé‰´keras |
|âœ… gpu training | 3.0.0    |ä¾èµ–accelerate|
|âœ… multi-gpus training(ddp) |   3.6.0 | ä¾èµ–accelerate|
|âœ… fp16/bf16 training|   3.6.0  | ä¾èµ–accelerate|
|âœ… tensorboard callback |   3.7.0  |ä¾èµ–tensorboard |
|âœ… wandb callback |  3.7.0 |ä¾èµ–wandb |

