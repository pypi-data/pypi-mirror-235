<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>31. Configuration File Shortcuts &#8212; AMPS User Guide develop documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'develop',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="32. Spark" href="spark.html" />
    <link rel="prev" title="30. AMPS Distribution Layout" href="distribution.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/flag_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">31. Configuration File Shortcuts</a><ul>
<li><a class="reference internal" href="#amps-configuration-file-special-characters">AMPS Configuration File Special Characters</a><ul>
<li><a class="reference internal" href="#state-of-the-world-file-name">State of the World File Name</a></li>
<li><a class="reference internal" href="#log-rotation-name">Log Rotation Name</a></li>
<li><a class="reference internal" href="#dates">Dates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-units-in-the-configuration">Using Units in the Configuration</a></li>
<li><a class="reference internal" href="#environment-variables-in-amps-configuration">Environment Variables in AMPS Configuration</a></li>
<li><a class="reference internal" href="#internal-environment-variables">Internal Environment Variables</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="distribution.html" title="previous chapter">30. AMPS Distribution Layout</a></li>
      <li>Next: <a href="spark.html" title="next chapter">32. Spark</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="configuration-file-shortcuts">
<h1>31. Configuration File Shortcuts<a class="headerlink" href="#configuration-file-shortcuts" title="Permalink to this headline">¶</a></h1>
<p>This appendix describes features that AMPS provides for simplifying configuration</p>
<div class="section" id="amps-configuration-file-special-characters">
<h2>AMPS Configuration File Special Characters<a class="headerlink" href="#amps-configuration-file-special-characters" title="Permalink to this headline">¶</a></h2>
<p>In AMPS there are a few special characters that you should be aware of
when creating your configuration file. These characters can provide some
handy short cuts and make configuration creation easier, but you should
also be aware of them so as not to introduce errors.</p>
<div class="section" id="state-of-the-world-file-name">
<h3>State of the World File Name<a class="headerlink" href="#state-of-the-world-file-name" title="Permalink to this headline">¶</a></h3>
<p>When specifying the file for a State of the World database, using the
<code class="docutils literal"><span class="pre">%n</span></code> string in the file name specifies that the AMPS server will use
the message type and topic name in that position to create a unique
filename. <a class="reference internal" href="#listing-sow-filename-token-replacement"><span class="std std-ref">Example 31.1</span></a>
shows how to use this in the AMPS configuration file.</p>
<div class="highlight-xml" id="listing-sow-filename-token-replacement"><div class="highlight"><pre><span></span> <span class="nt">&lt;SOW&gt;</span>
    <span class="nt">&lt;Topic&gt;</span>
        <span class="nt">&lt;Topic&gt;</span>Customers<span class="nt">&lt;/Topic&gt;</span>
        <span class="nt">&lt;FileName&gt;</span>./sow/%n.sow<span class="nt">&lt;/FileName&gt;</span>
        <span class="nt">&lt;MessageType&gt;</span>json<span class="nt">&lt;/MessageType&gt;</span>
        <span class="nt">&lt;Key&gt;</span>/customerId<span class="nt">&lt;/Key&gt;</span>
    <span class="nt">&lt;/Topic&gt;</span>
<span class="nt">&lt;/SOW&gt;</span>
</pre></div>
</div>
<p><strong>Example 31.1:</strong> <em>SOW file name tokens used in configuration file</em></p>
</div>
<div class="section" id="log-rotation-name">
<h3>Log Rotation Name<a class="headerlink" href="#log-rotation-name" title="Permalink to this headline">¶</a></h3>
<p>When specifying an AMPS log file which has <code class="docutils literal"><span class="pre">RotationThreshold</span></code>
specified, using the <code class="docutils literal"><span class="pre">%n</span></code> string in the log file name is a useful
mechanism for ensuring the name of the log file is unique and
sequential. <a class="reference internal" href="#listing-filename-token-replacement"><span class="std std-ref">Example 31.2</span></a> shows a file name
token replacement in the AMPS configuration file.</p>
<div class="highlight-xml" id="listing-filename-token-replacement"><div class="highlight"><pre><span></span><span class="nt">&lt;Logging&gt;</span>
    <span class="nt">&lt;Target&gt;</span>
        <span class="nt">&lt;Protocol&gt;</span>file<span class="nt">&lt;/Protocol&gt;</span>
        <span class="nt">&lt;Level&gt;</span>info<span class="nt">&lt;/Level&gt;</span>
        <span class="nt">&lt;FileName&gt;</span>log/log-%n.log<span class="nt">&lt;/FileName&gt;</span>
        <span class="nt">&lt;RotationThreshold&gt;</span>2G<span class="nt">&lt;/RotationThreshold&gt;</span>
    <span class="nt">&lt;/Target&gt;</span>
<span class="nt">&lt;/Logging&gt;</span>
</pre></div>
</div>
<p><strong>Example 31.2:</strong> <em>Log file name used in configuration file</em></p>
<p>In the above example, a log file will be created in the <code class="docutils literal"><span class="pre">AMPSDIR/log/</span></code>
directory. The first time this file is created, it will be named
<code class="docutils literal"><span class="pre">log-1.log</span></code>. Once the log file reaches the <code class="docutils literal"><span class="pre">RotationThreshold</span></code> limit
of 2G, the previous log file will be saved, and the new log file name
will be incremented by one. Thus, the next log file will be named
<code class="docutils literal"><span class="pre">AMPSDIR/log/log-2.log</span></code>.</p>
</div>
<div class="section" id="dates">
<h3>Dates<a class="headerlink" href="#dates" title="Permalink to this headline">¶</a></h3>
<p>AMPS allows administrators to use date-based file names when specifying
the file name in the configuration, as demonstrated in
<a class="reference internal" href="#listing-date-tokens-in-config"><span class="std std-ref">Example 31.3</span></a>.</p>
<div class="highlight-xml" id="listing-date-tokens-in-config"><div class="highlight"><pre><span></span><span class="nt">&lt;Logging&gt;</span>
    <span class="nt">&lt;Target&gt;</span>
        <span class="nt">&lt;Protocol&gt;</span>file<span class="nt">&lt;/Protocol&gt;</span>
        <span class="nt">&lt;Level&gt;</span>info<span class="nt">&lt;/Level&gt;</span>
        <span class="nt">&lt;FileName&gt;</span>
            log/log-%Y-%m-%dT%H%M%S.log
        <span class="nt">&lt;/FileName&gt;</span>
        <span class="nt">&lt;RotationThreshold&gt;</span>2G<span class="nt">&lt;/RotationThreshold&gt;</span>
    <span class="nt">&lt;/Target&gt;</span>
<span class="nt">&lt;/Logging&gt;</span>
</pre></div>
</div>
<p><strong>Example 31.3:</strong> <em>Date tokens used in configuration file</em></p>
<p>In the above example, a log file will be created in the <code class="docutils literal"><span class="pre">$AMPSDIR/log</span></code>
named <code class="docutils literal"><span class="pre">2011-01-01-120000.log</span></code> if the log was created at noon on
January 1, 2011.</p>
<p>AMPS provides full support for the date tokens provided by the standard
strftime function, with the exception of <code class="docutils literal"><span class="pre">%n</span></code>, as described above. The
following table shows some of the most commonly used tokens:</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="55%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Token</th>
<th class="head">Provides</th>
<th class="head">Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>%a</td>
<td>Short weekday name</td>
<td>Fri</td>
</tr>
<tr class="row-odd"><td>%A</td>
<td>Full weekday name</td>
<td>Friday</td>
</tr>
<tr class="row-even"><td>%b</td>
<td>Short month name</td>
<td>Feb</td>
</tr>
<tr class="row-odd"><td>%B</td>
<td>Full month name</td>
<td>February</td>
</tr>
<tr class="row-even"><td>%c</td>
<td>Simple date and time</td>
<td>Fri Feb 14 17:25:00
2014</td>
</tr>
<tr class="row-odd"><td>%C</td>
<td>Century</td>
<td>20</td>
</tr>
<tr class="row-even"><td>%d</td>
<td>Day of the month (leading zero if
necessary)</td>
<td>05</td>
</tr>
<tr class="row-odd"><td>%D</td>
<td>Short date format (MM/DD/YY)</td>
<td>02/20/14</td>
</tr>
<tr class="row-even"><td>%e</td>
<td>Day of the month (leading space if
necessary)</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>%F</td>
<td>Short date format (YYYY-MM-DD)</td>
<td>2014-02-20</td>
</tr>
<tr class="row-even"><td>%H</td>
<td>Hour (00-23)</td>
<td>17</td>
</tr>
<tr class="row-odd"><td>%I</td>
<td>Hour (00-12)</td>
<td>05</td>
</tr>
<tr class="row-even"><td>%j</td>
<td>Day of the year (001-366)</td>
<td>051</td>
</tr>
<tr class="row-odd"><td>%m</td>
<td>Month (01-12)</td>
<td>02</td>
</tr>
<tr class="row-even"><td>%p</td>
<td>AM or PM</td>
<td>PM</td>
</tr>
<tr class="row-odd"><td>%r</td>
<td>Current time, 12 hour format</td>
<td>05:25:00 pm</td>
</tr>
<tr class="row-even"><td>%R</td>
<td>Current time, 24 hour format</td>
<td>17:25</td>
</tr>
<tr class="row-odd"><td>%T</td>
<td>ISO 8601 Time format</td>
<td>17:25:00</td>
</tr>
<tr class="row-even"><td>%u</td>
<td>ISO 8601 day of the week (1-7, Monday =
1)</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>%V</td>
<td>ISO 8601 week number (00-53)</td>
<td>07</td>
</tr>
<tr class="row-even"><td>%y</td>
<td>Year, last two digits</td>
<td>14</td>
</tr>
<tr class="row-odd"><td>%Y</td>
<td>Year, four digits</td>
<td>2014</td>
</tr>
<tr class="row-even"><td>%Z</td>
<td>Timezone name or abbreviation (blank if
undetermined)</td>
<td>PST</td>
</tr>
</tbody>
</table>
<p><strong>Table 31.1:</strong> <em>Commonly Used Date and Time Tokens</em></p>
</div>
</div>
<div class="section" id="using-units-in-the-configuration">
<h2>Using Units in the Configuration<a class="headerlink" href="#using-units-in-the-configuration" title="Permalink to this headline">¶</a></h2>
<p>To make configuration easy, AMPS permits the use of units to expand
values. For example, if a time interval is measured in seconds, then the
letter <code class="docutils literal"><span class="pre">s</span></code> can be appended to the value. For example, the following
SOW topic definition used the <code class="docutils literal"><span class="pre">Expiration</span></code> tag to set the record
expiration to 86400 seconds (one day).</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;SOW&gt;</span>
    <span class="nt">&lt;Topic&gt;</span>
        ...

        <span class="nt">&lt;Expiration&gt;</span>86400s <span class="nt">&lt;/Expiration&gt;</span>

        ...
    <span class="nt">&lt;/Topic&gt;</span>
<span class="nt">&lt;/SOW&gt;</span>
</pre></div>
</div>
<p><strong>Example 31.4:</strong> <em>Expiration using seconds</em></p>
<p>An even easier way to specify an expiration of one day is to use the
following <code class="docutils literal"><span class="pre">Expiration</span></code>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;SOW&gt;</span>
    <span class="nt">&lt;Topic&gt;</span>
        ...

        <span class="nt">&lt;Expiration&gt;</span>1d<span class="nt">&lt;/Expiration&gt;</span>

        ...
    <span class="nt">&lt;/Topic&gt;</span>
<span class="nt">&lt;/SOW&gt;</span>
</pre></div>
</div>
<p><strong>Example 31.5:</strong> <em>Expiration using days</em></p>
<p><a class="reference internal" href="#table-configref-time-units"><span class="std std-ref">Table 31.2</span></a> shows a listing of the time units AMPS supports in
the configuration file.</p>
<table border="1" class="docutils" id="table-configref-time-units">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Units</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ns</span></code></td>
<td>nanoseconds</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">us</span></code></td>
<td>microseconds</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ms</span></code></td>
<td>milliseconds</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">s</span></code></td>
<td>seconds</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">m</span></code></td>
<td>minutes</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">h</span></code></td>
<td>hours</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">d</span></code></td>
<td>days</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">w</span></code></td>
<td>weeks</td>
</tr>
</tbody>
</table>
<p><strong>Table 31.2:</strong> <em>AMPS Configuration - Time Units</em></p>
<p>AMPS configuration supports a similar mechanism for byte-based units
when specifying sizes in the configuration file. <a class="reference internal" href="#table-configref-byte-units"><span class="std std-ref">Table 31.3</span></a>
shows a listing of the byte units AMPS supports in the configuration
file.</p>
<table border="1" class="docutils" id="table-configref-byte-units">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Units</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kb</span></code></td>
<td>kilobytes</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">mb</span></code></td>
<td>megabytes</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">gb</span></code></td>
<td>gigabytes</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">tb</span></code></td>
<td>terabytes</td>
</tr>
</tbody>
</table>
<p><strong>Table 31.3:</strong> <em>AMPS Configuration - Byte Units</em></p>
<p>Dealing with large numbers in AMPS configuration can also be simplified
by using common exponent values to handle raw values. This means that
instead of having to input <code class="docutils literal"><span class="pre">10000000</span></code> to represent ten million, a user
can input <code class="docutils literal"><span class="pre">10M</span></code>. <a class="reference internal" href="#table-configref-numeric-units"><span class="std std-ref">Table 31.4</span></a> contains a list of the exponents
supported.</p>
<table border="1" class="docutils" id="table-configref-numeric-units">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Units</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>k</td>
<td>10<sup>3</sup> - thousand</td>
</tr>
<tr class="row-odd"><td>M</td>
<td>10<sup>6</sup> - million</td>
</tr>
</tbody>
</table>
<p><strong>Table 31.4:</strong> <em>AMPS Configuration - Numeric Units</em></p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">To make it easier for users to remember the units, AMPS interval
and byte units are not case sensitive.</p>
</div>
</div>
<div class="section" id="environment-variables-in-amps-configuration">
<h2>Environment Variables in AMPS Configuration<a class="headerlink" href="#environment-variables-in-amps-configuration" title="Permalink to this headline">¶</a></h2>
<p>AMPS configuration also allows for environment variables to be used as
part of the data when specifying a configuration file. These variables
can be set in the environment when AMPS starts, or passed to AMPS using
the <code class="docutils literal"><span class="pre">-D</span></code> option on the command line.</p>
<p>If a global system variable is commonly used in an organization, then it
may be useful to define this in one location and re-use it across
multiple AMPS installations or applications. AMPS will replace any token
wrapped in <code class="docutils literal"><span class="pre">${}</span></code> with the environment variable defined in the current
user operating system environment. <a class="reference internal" href="#listing-env-var-in-config"><span class="std std-ref">Example 31.6</span></a>
demonstrates how the environment variable <code class="docutils literal"><span class="pre">ENV_LOG</span></code> is used to define a global
environment variable for the location of the host logging.</p>
<div class="highlight-xml" id="listing-env-var-in-config"><div class="highlight"><pre><span></span><span class="nt">&lt;Logging&gt;</span>
    <span class="nt">&lt;Target&gt;</span>
        <span class="nt">&lt;Protocol&gt;</span>file<span class="nt">&lt;/Protocol&gt;</span>
        <span class="nt">&lt;FileName&gt;</span>${ENV_LOG}<span class="nt">&lt;/FileName&gt;</span>
        <span class="nt">&lt;Level&gt;</span>info<span class="nt">&lt;/Level&gt;</span>
        <span class="nt">&lt;RotationThreshold&gt;</span>2G<span class="nt">&lt;/RotationThreshold&gt;</span>
    <span class="nt">&lt;/Target&gt;</span>
<span class="nt">&lt;/Logging&gt;</span>
</pre></div>
</div>
<p><strong>Example 31.6:</strong> <em>Environment variables in AMPS configuration</em></p>
</div>
<div class="section" id="internal-environment-variables">
<span id="index-0"></span><h2>Internal Environment Variables<a class="headerlink" href="#internal-environment-variables" title="Permalink to this headline">¶</a></h2>
<p>In addition to supporting custom environment variables, AMPS includes
a set of environment variables automatically populated by the server.</p>
<p>These variables are listed below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable Name</th>
<th class="head">Contains</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">AMPS_CONFIG_DIRECTORY</span></code></td>
<td>Directory in which the configuration file
used to start AMPS is located.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">AMPS_CONFIG_PATH</span></code></td>
<td>Full path to the configuration file used
to start AMPS, including the file name.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">AMPS_VERSION</span></code></td>
<td>Full version number of the AMPS server.</td>
</tr>
</tbody>
</table>
<p>When AMPS processes the configuration file, AMPS expands these variables
just as though they were set in the environment. For example, assume
that AMPS was started with the following command at the command prompt:</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="o">%&gt;./</span><span class="n">ampServer</span> <span class="o">../</span><span class="n">amps</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">xml</span>
</pre></div>
</div>
<p>Given this command, the log file configuration option shown in
<a class="reference internal" href="#listing-amps-config-env-var"><span class="std std-ref">Example 31.7</span></a> can be used to instruct AMPS to create the log files
in the same parent directory as the configuration file — in this case
<code class="docutils literal"><span class="pre">../amps/config/logs/infoLog.log</span></code>.</p>
<div class="highlight-xml" id="listing-amps-config-env-var"><div class="highlight"><pre><span></span><span class="nt">&lt;Logging&gt;</span>
    <span class="nt">&lt;Target&gt;</span>
        <span class="nt">&lt;Protocol&gt;</span>file<span class="nt">&lt;/Protocol&gt;</span>
        <span class="nt">&lt;FileName&gt;</span>${AMPS_CONFIG_DIRECTORY}/logs/infoLog.log<span class="nt">&lt;/FileName&gt;</span>
        <span class="nt">&lt;Level&gt;</span>info<span class="nt">&lt;/Level&gt;</span>
        <span class="nt">&lt;RotationThreshold&gt;</span>2G<span class="nt">&lt;/RotationThreshold&gt;</span>
    <span class="nt">&lt;/Target&gt;</span>
<span class="nt">&lt;/Logging&gt;</span>
</pre></div>
</div>
<p><strong>Example 31.7:</strong> <em>AMPS_CONFIG_DIRECTORY environment variable example</em></p>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2023 60East Technologies, Inc. (version develop).
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>