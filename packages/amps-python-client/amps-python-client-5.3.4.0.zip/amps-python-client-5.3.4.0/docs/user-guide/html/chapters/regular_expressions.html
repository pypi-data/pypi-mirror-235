<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6. Regular Expressions &#8212; AMPS User Guide develop documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'develop',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. State of the World (SOW)" href="sow.html" />
    <link rel="prev" title="5. AMPS Functions" href="amps_functions.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/flag_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">6. Regular Expressions</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#raw-strings">Raw Strings</a></li>
<li><a class="reference internal" href="#topic-regular-expressions">Topic Regular Expressions</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="amps_functions.html" title="previous chapter">5. AMPS Functions</a></li>
      <li>Next: <a href="sow.html" title="next chapter">7. State of the World (SOW)</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="regular-expressions">
<span id="ug-regular-expressions"></span><span id="index-0"></span><h1>6. Regular Expressions<a class="headerlink" href="#regular-expressions" title="Permalink to this headline">¶</a></h1>
<p>Regular expression matching provides precision, power, and flexibility
for matching patterns. AMPS supports regular expression matching on
topics and within content filters. Regular expressions are implemented
in AMPS using the Perl-Compatible Regular Expressions (PCRE) library.
For a complete definition of the supported regular expression syntax,
please refer to:</p>
<p><a class="reference external" href="http://perldoc.perl.org/perlre.html">http://perldoc.perl.org/perlre.html</a></p>
<p>To use regular expressions for topic matching, provide a regular
expression pattern where you would normally provide a topic name.</p>
<p>To use regular expressions in content filtering, compare strings to
regular expressions using the <code class="docutils literal"><span class="pre">LIKE</span></code> operator. The syntax of the
<code class="docutils literal"><span class="pre">LIKE</span></code> operator is:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">string</span> <span class="n">LIKE</span> <span class="n">pattern</span>
</pre></div>
</div>
<p>where a string is any expression that provides a string, and pattern is
a literal regular expression pattern.</p>
<p>This chapter presents a brief overview of regular expressions in AMPS.
However, this chapter is not exhaustive. For more information on regular
expression matching, see the PCRE site mentioned above.</p>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of a content filter for messages that will match any
message meeting the following criteria:</p>
<ul class="simple">
<li>Regular expression match of symbols of 2 or 3 characters starting
with “IB”</li>
<li>Regular expression match of prices starting with “90”</li>
<li>Numeric comparison of prices less than 91</li>
</ul>
<p>and, the corresponding content filter:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">/</span><span class="n">FIXML</span><span class="o">/</span><span class="n">Order</span><span class="o">/</span><span class="n">Instrmt</span><span class="o">/</span><span class="nd">@Sym</span> <span class="n">LIKE</span> <span class="s2">&quot;^IB.?$&quot;</span><span class="p">)</span> <span class="n">AND</span>
<span class="p">(</span><span class="o">/</span><span class="n">FIXML</span><span class="o">/</span><span class="n">Order</span><span class="o">/</span><span class="nd">@Px</span> <span class="n">LIKE</span> <span class="s2">&quot;^90\..*&quot;</span> <span class="n">AND</span> <span class="o">/</span><span class="n">FIXML</span><span class="o">/</span><span class="n">Order</span><span class="o">/</span><span class="nd">@Px</span> <span class="o">&lt;</span> <span class="mf">91.0</span><span class="p">)</span>
</pre></div>
</div>
<p>The tables below (
<a class="reference internal" href="#table-regex-meta-chars"><span class="std std-ref">Table 6.1</span></a>,
<a class="reference internal" href="#table-regex-repetition-constructs"><span class="std std-ref">Table 6.2</span></a>, and
<a class="reference internal" href="#table-regex-behavior-modifiers"><span class="std std-ref">Table 6.3</span></a>
) contain a brief summary of special characters and constructs available within regular expressions.</p>
<p>Here are more examples of using regular expressions within AMPS.</p>
<p id="index-1">Use <code class="docutils literal"><span class="pre">(?i)</span></code> to enable case-insensitive regular expression searching. For example, the following
filter will be true regardless if <code class="docutils literal"><span class="pre">/client/country</span></code> contains “US” or
“us”.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">/</span><span class="n">client</span><span class="o">/</span><span class="n">country</span> <span class="n">LIKE</span> <span class="s2">&quot;(?i)ˆus$&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To match messages where tag 55 has a <code class="docutils literal"><span class="pre">TRADE</span></code> suffix, use the following
filter:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">/</span><span class="mi">55</span> <span class="n">LIKE</span> <span class="s2">&quot;TRADE$&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To match messages where tag 109 has a <code class="docutils literal"><span class="pre">US</span></code> prefix and a <code class="docutils literal"><span class="pre">TRADE</span></code>
suffix, with case insensitive matching, use the following filter:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">/</span><span class="mi">109</span> <span class="n">LIKE</span> <span class="s2">&quot;(?i)ˆUS.*TRADE$&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table border="1" class="docutils" id="table-regex-meta-chars">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Character
s</strong></th>
<th class="head"><strong>Meaning</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>^</td>
<td>Beginning of string</td>
</tr>
<tr class="row-odd"><td>$</td>
<td>End of string</td>
</tr>
<tr class="row-even"><td>.</td>
<td>Any character except a newline</td>
</tr>
<tr class="row-odd"><td>*</td>
<td>Match previous 0 or more times</td>
</tr>
<tr class="row-even"><td>+</td>
<td>Match previous 1 or more times</td>
</tr>
<tr class="row-odd"><td>?</td>
<td>Match previous 0 or 1 times</td>
</tr>
<tr class="row-even"><td>|</td>
<td>The previous is an alternative to the following</td>
</tr>
<tr class="row-odd"><td>()</td>
<td>Grouping of expression</td>
</tr>
<tr class="row-even"><td>[]</td>
<td>Set of characters</td>
</tr>
<tr class="row-odd"><td>{}</td>
<td>Repetition modifier</td>
</tr>
<tr class="row-even"><td>\</td>
<td>Escape for special characters</td>
</tr>
</tbody>
</table>
<p><strong>Table 6.1:</strong> <em>Regular Expression Meta-characters</em></p>
<table border="1" class="docutils" id="table-regex-repetition-constructs">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Construct</strong></th>
<th class="head"><strong>Meaning</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>a</em>*</td>
<td>Zero or more <em>a</em>&#8216;s</td>
</tr>
<tr class="row-odd"><td><em>a</em>+</td>
<td>One or more <em>a</em>&#8216;s</td>
</tr>
<tr class="row-even"><td><em>a</em>?</td>
<td>Zero or one <em>a</em>&#8216;s</td>
</tr>
<tr class="row-odd"><td><em>a</em>{<em>m</em>}</td>
<td>Exactly <em>m a</em>&#8216;s</td>
</tr>
<tr class="row-even"><td><em>a</em>{<em>m</em>,}</td>
<td>At least <em>m a</em>&#8216;s</td>
</tr>
<tr class="row-odd"><td><em>a</em>{<em>m</em>,<em>n</em>}</td>
<td>At least <em>m</em>, but no more than <em>n a</em>&#8216;s</td>
</tr>
</tbody>
</table>
<p><strong>Table 6.2:</strong> <em>Regular Expression Repetition Constructs</em></p>
<table border="1" class="docutils" id="table-regex-behavior-modifiers">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Modifier</strong></th>
<th class="head"><strong>Meaning</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>i</td>
<td>Case insensitive search</td>
</tr>
<tr class="row-odd"><td>m</td>
<td>Multi-line search</td>
</tr>
<tr class="row-even"><td>s</td>
<td>Any character (including newlines) can be matched by a .
character</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Unescaped white space is ignored in the pattern.</td>
</tr>
<tr class="row-even"><td>A</td>
<td>Constrain the pattern to only match the beginning of a
string.</td>
</tr>
<tr class="row-odd"><td>U</td>
<td>Make the quantifiers non-greedy by default (the
quantifiers are greedy and try to match as much as
possible by default.)</td>
</tr>
</tbody>
</table>
<p><strong>Table 6.3:</strong> <em>Regular Expression Behavior Modifiers</em></p>
</div>
<div class="section" id="raw-strings">
<h2>Raw Strings<a class="headerlink" href="#raw-strings" title="Permalink to this headline">¶</a></h2>
<p id="index-2">AMPS additionally provides support for <em>raw strings</em> which are strings
prefixed by an &#8216;r&#8217; or &#8216;R&#8217; character. Raw strings use different rules for
how a backslash escape sequence is interpreted by the parser. When a
string literal is provided as a raw string, the characters in the raw
string are matched exactly, even when those characters are special
characters for a regular expression.</p>
<p>In the example below, the raw string - noted by the <code class="docutils literal"><span class="pre">r</span></code> prefix of the
string literal in the second operand of the <code class="docutils literal"><span class="pre">LIKE</span></code> predicate (
<a class="reference internal" href="#listing-raw-string"><span class="std std-ref">Example 6.1</span></a>
) - causes AMPS to search for the literal characters
<code class="docutils literal"><span class="pre">++</span></code> in the results, without requiring those characters to be escaped (
<a class="reference internal" href="#listing-regular-string"><span class="std std-ref">Example 6.2</span></a>
). In this example we are querying for a string that
contains the programming language named C++. In the regular string, we
are required to escape the <code class="docutils literal"><span class="pre">'+'</span></code> character since it is also used in a
regular expression as the “match previous 1 or more times” regular
expression character. In the raw string we can use <code class="docutils literal"><span class="pre">r'C++'</span></code> to search
for the string and not have to escape the special <code class="docutils literal"><span class="pre">'+'</span></code> character.</p>
<div class="code highlight-default" id="listing-raw-string"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">FIXML</span><span class="o">/</span><span class="n">Language</span> <span class="n">LIKE</span> <span class="sa">r</span><span class="s1">&#39;C++&#39;</span>
</pre></div>
</div>
<p><strong>Example 6.1:</strong> <em>Raw String Example</em></p>
<div class="code highlight-default" id="listing-regular-string"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">FIXML</span><span class="o">/</span><span class="n">Language</span> <span class="n">LIKE</span> <span class="s1">&#39;C\+\+&#39;</span>
</pre></div>
</div>
<p><strong>Example 6.2:</strong> <em>Regular String Example</em></p>
</div>
<div class="section" id="topic-regular-expressions">
<h2>Topic Regular Expressions<a class="headerlink" href="#topic-regular-expressions" title="Permalink to this headline">¶</a></h2>
<p>As mentioned previously, AMPS supports regular expression filtering for
topics, in addition to content filters. Regular expressions use the same
grammar described in content filtering. Regular expression matching for
topics is enabled in an AMPS instance by default.</p>
<p>Subscriptions or queries that use a regular expression for the topic
name provide all matching records from AMPS topics where the name of the
topic matches the regular expression used for the subscription or query.
For example, if your AMPS configuration has three SOW topics,
<code class="docutils literal"><span class="pre">Topic_A</span></code>, <code class="docutils literal"><span class="pre">Topic_B</span></code> and <code class="docutils literal"><span class="pre">Topic_C</span></code> and you wish to search for all
messages in all of your SOW topics for records where the <code class="docutils literal"><span class="pre">Name</span></code> field
is equal to “Bob”, then you could use a <code class="docutils literal"><span class="pre">sow</span></code> command with a topic of
<code class="docutils literal"><span class="pre">^Topic_.*</span></code> and a filter of <code class="docutils literal"><span class="pre">/FIXML/&#64;Name='Bob'</span></code> to return all
matching messages that match the filter in all of the topics that match
the topic regular expression.</p>
<p>Notice that, as with the <code class="docutils literal"><span class="pre">LIKE</span></code> expression, a regular expression
will match at any position in the topic name. To anchor the match
to the beginning of the string, use the <code class="docutils literal"><span class="pre">^</span></code> directive at the
beginning of the regular expression. To anchor the match to the
end of the string, use the <code class="docutils literal"><span class="pre">$</span></code> directive at the end of the string.</p>
<p>For example, to match a topic with <code class="docutils literal"><span class="pre">&quot;order&quot;</span></code> anywhere in the topic
name, you could use the regular expression <code class="docutils literal"><span class="pre">order.*</span></code>  (the
ending <code class="docutils literal"><span class="pre">.*</span></code> matches zero or more characters, but lets AMPS know
to interpret this as a regular expression). To match only
topics that start with <code class="docutils literal"><span class="pre">order</span></code>, you would use the regular expression
<code class="docutils literal"><span class="pre">^order</span></code>.  To match topics that end with <code class="docutils literal"><span class="pre">order</span></code>, you would
use the regular expression <code class="docutils literal"><span class="pre">order$</span></code>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Results returned when performing a topic regular expression
query will follow “configuration order” — meaning that the
topics will be searched in the order that they appear in your
AMPS configuration file. Using the above query example with
<code class="docutils literal"><span class="pre">Topic_A</span></code>, <code class="docutils literal"><span class="pre">Topic_B</span></code> and <code class="docutils literal"><span class="pre">Topic_C</span></code>, if the configuration
file has these topics in that exact order, the results will be
returned first from <code class="docutils literal"><span class="pre">Topic_A</span></code>, then from <code class="docutils literal"><span class="pre">Topic_B</span></code> and
finally the results from <code class="docutils literal"><span class="pre">Topic_C</span></code>. As with other queries,
AMPS does not make any guarantees about the ordering of results
within any given topic query.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2023 60East Technologies, Inc. (version develop).
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>