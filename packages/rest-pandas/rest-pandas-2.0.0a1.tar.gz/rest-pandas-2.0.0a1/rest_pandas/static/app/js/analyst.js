import{modules as e}from"./wq.js";import t,{Series as n,Scatter as r,Boxplot as a}from"./chart.js";const{react:o}=e,{useCallback:l}=o,{useEffect:i}=o,{useMemo:c}=o,{useState:s}=o,{"@mui/material":u}=e,{Badge:p}=u,{Grid:f}=u,{Menu:h}=u,{MenuItem:m}=u,{useMediaQuery:d}=u,{"@wq/react":v}=e;v.default;const{AutoInput:g}=v,{useApp:y}=v,{useComponents:b}=v,{useIcon:w}=v,{useNav:E}=v,{useRenderContext:C}=v,{useRouteInfo:x}=v,{"prop-types":A}=e;function AnalystDownload({url:e,title:t,formats:n}){const[r,a]=s(null),{Button:l,IconButton:i,HorizontalView:c,Typography:u,View:p}=b(),f=d((e=>e.breakpoints.down("md")))?i:l,v="analyst-download",g=new URL(e,window.location.href),y=g.pathname.replace(/\.[^.]+$/,""),w=g.search;return o.createElement(o.Fragment,null,o.createElement(c,null,t?o.createElement(u,{variant:"h5"},t):o.createElement(p,null),o.createElement(f,{"aria-controls":v,onClick:e=>a(e.target),icon:"download",variant:"contained",color:"primary",title:"Download Data"},"Download Data")),o.createElement(h,{id:v,anchorEl:r,open:!!r,onClose:()=>a(null)},Object.entries(n).map((([e,t])=>o.createElement(m,{key:e,component:"a",href:`${y}.${e}${w}`,target:"_blank"},t)))))}AnalystDownload.propTypes={url:A.string,title:A.string,formats:A.object};var T={},j={};function k(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function O(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function V(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function z(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),a=e.getUTCSeconds(),o=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+V(-t,6):t>9999?"+"+V(t,6):V(t,4))+"-"+V(e.getUTCMonth()+1,2)+"-"+V(e.getUTCDate(),2)+(o?"T"+V(n,2)+":"+V(r,2)+":"+V(a,2)+"."+V(o,3)+"Z":a?"T"+V(n,2)+":"+V(r,2)+":"+V(a,2)+"Z":r||n?"T"+V(n,2)+":"+V(r,2)+"Z":"")}var _=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,a=[],o=e.length,l=0,i=0,c=o<=0,s=!1;function u(){if(c)return j;if(s)return s=!1,T;var t,r,a=l;if(34===e.charCodeAt(a)){for(;l++<o&&34!==e.charCodeAt(l)||34===e.charCodeAt(++l););return(t=l)>=o?c=!0:10===(r=e.charCodeAt(l++))?s=!0:13===r&&(s=!0,10===e.charCodeAt(l)&&++l),e.slice(a+1,t-1).replace(/""/g,'"')}for(;l<o;){if(10===(r=e.charCodeAt(t=l++)))s=!0;else if(13===r)s=!0,10===e.charCodeAt(l)&&++l;else if(r!==n)continue;return e.slice(a,t)}return c=!0,e.slice(a,o)}for(10===e.charCodeAt(o-1)&&--o,13===e.charCodeAt(o-1)&&--o;(r=u())!==j;){for(var p=[];r!==T&&r!==j;)p.push(r),r=u();t&&null==(p=t(p,i++))||a.push(p)}return a}function a(t,n){return t.map((function(t){return n.map((function(e){return l(t[e])})).join(e)}))}function o(t){return t.map(l).join(e)}function l(e){return null==e?"":e instanceof Date?z(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,a,o=r(e,(function(e,r){if(n)return n(e,r-1);a=e,n=t?function(e,t){var n=k(e);return function(r,a){return t(n(r),a,e)}}(e,t):k(e)}));return o.columns=a||[],o},parseRows:r,format:function(t,n){return null==n&&(n=O(t)),[n.map(l).join(e)].concat(a(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=O(e)),a(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:l}}(","),S=_.parse,F=_.parseRows;function D(e,t={}){var n,r,a,o=[],l=[],i=[];if(","!=e.charAt(0)){r=[],S(e).forEach((function(e){var t,n;for(t in e)n=e[t],""!==e[t]&&(e[t]=isNaN(+n)?n:+n);r.push(e)}));const n=[{data:r}];return t.flatten?M(n):n}return F(e).forEach((function(e,t){var c;r?function(e){var t={};n.forEach((function(n,r){t[n]=e[r]}));var r=[];e.slice(n.length).forEach((function(e,o){var l,c,s,u;if(""!==e){if(s=i[o],u=a[o+n.length],!(c=r[s])){for(l in c={},t)c[l]=t[l];r[s]=c}c[u]=isNaN(+e)?e:+e}})),r.forEach((function(e,t){l[t].data.push(e)}))}(e):0===t&&""===e[0]?function(e){a=e}(e):a&&""!==e[e.length-1]?function(e){var t=e[0],n=a.lastIndexOf("")+1;e.slice(n).forEach((function(e,n){o[n]||(o[n]={}),o[n][t]="-"==e?null:e}))}(e):a?(!function(e){if(e.indexOf("")!=a.lastIndexOf("")+1)throw"Header mismatch!";n=e.slice(0,e.indexOf(""))}(e),c={},o.forEach((function(e,t){var n=function(e){var t="";return Object.keys(e).sort().forEach((function(n){t+=n+"="+e[n]+"\n"})),t}
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */(e),r=c[n];void 0===r&&(r=l.length,c[n]=r,e.data=[],l.push(e)),i[t]=r})),r=!0):(!function(e){n=[e[0]],a=[],e.slice(1).forEach((function(e,t){l[t]={id:e,data:[]},i[t]=t,a[t+1]="value"}))}(e),r=!0)})),t.flatten?M(l):l}function M(e){const t=[];return e.forEach((e=>{const{data:n,...r}=e;n.forEach((e=>{t.push({...r,...e})}))})),t.datasets=e,t}var I=Object.prototype.toString,H=Array.isArray||function(e){return"[object Array]"===I.call(e)};function U(e){return"function"==typeof e}function W(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function L(e,t){return null!=e&&"object"==typeof e&&t in e}var B=RegExp.prototype.test;var R=/\S/;function P(e){return!function(e,t){return B.call(e,t)}(R,e)}var $={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var N=/\s*/,q=/\s+/,G=/\s*=/,Y=/\s*\}/,Z=/#|\^|\/|>|\{|&|=|!/;function Scanner(e){this.string=e,this.tail=e,this.pos=0}function Context(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function Writer(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Scanner.prototype.eos=function(){return""===this.tail},Scanner.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},Scanner.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},Context.prototype.push=function(e){return new Context(e,this)},Context.prototype.lookup=function(e){var t,n,r,a=this.cache;if(a.hasOwnProperty(e))t=a[e];else{for(var o,l,i,c=this,s=!1;c;){if(e.indexOf(".")>0)for(o=c.view,l=e.split("."),i=0;null!=o&&i<l.length;)i===l.length-1&&(s=L(o,l[i])||(n=o,r=l[i],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(r))),o=o[l[i++]];else o=c.view[e],s=L(c.view,e);if(s){t=o;break}c=c.parent}a[e]=t}return U(t)&&(t=t.call(this.view)),t},Writer.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},Writer.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||J.tags).join(":"),a=void 0!==n,o=a?n.get(r):void 0;return null==o&&(o=function(e,t){if(!e)return[];var n,r,a,o=!1,l=[],i=[],c=[],s=!1,u=!1,p="",f=0;function h(){if(s&&!u)for(;c.length;)delete i[c.pop()];else c=[];s=!1,u=!1}function m(e){if("string"==typeof e&&(e=e.split(q,2)),!H(e)||2!==e.length)throw new Error("Invalid tags: "+e);n=new RegExp(W(e[0])+"\\s*"),r=new RegExp("\\s*"+W(e[1])),a=new RegExp("\\s*"+W("}"+e[1]))}m(t||J.tags);for(var d,v,g,y,b,w,E=new Scanner(e);!E.eos();){if(d=E.pos,g=E.scanUntil(n))for(var C=0,x=g.length;C<x;++C)P(y=g.charAt(C))?(c.push(i.length),p+=y):(u=!0,o=!0,p+=" "),i.push(["text",y,d,d+1]),d+=1,"\n"===y&&(h(),p="",f=0,o=!1);if(!E.scan(n))break;if(s=!0,v=E.scan(Z)||"name",E.scan(N),"="===v?(g=E.scanUntil(G),E.scan(G),E.scanUntil(r)):"{"===v?(g=E.scanUntil(a),E.scan(Y),E.scanUntil(r),v="&"):g=E.scanUntil(r),!E.scan(r))throw new Error("Unclosed tag at "+E.pos);if(b=">"==v?[v,g,d,E.pos,p,f,o]:[v,g,d,E.pos],f++,i.push(b),"#"===v||"^"===v)l.push(b);else if("/"===v){if(!(w=l.pop()))throw new Error('Unopened section "'+g+'" at '+d);if(w[1]!==g)throw new Error('Unclosed section "'+w[1]+'" at '+d)}else"name"===v||"{"===v||"&"===v?u=!0:"="===v&&m(g)}if(h(),w=l.pop())throw new Error('Unclosed section "'+w[1]+'" at '+E.pos);return function(e){for(var t,n=[],r=n,a=[],o=0,l=e.length;o<l;++o)switch((t=e[o])[0]){case"#":case"^":r.push(t),a.push(t),r=t[4]=[];break;case"/":a.pop()[5]=t[2],r=a.length>0?a[a.length-1][4]:n;break;default:r.push(t)}return n}(function(e){for(var t,n,r=[],a=0,o=e.length;a<o;++a)(t=e[a])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}(i))}(e,t),a&&n.set(r,o)),o},Writer.prototype.render=function(e,t,n,r){var a=this.getConfigTags(r),o=this.parse(e,a),l=t instanceof Context?t:new Context(t,void 0);return this.renderTokens(o,l,n,e,r)},Writer.prototype.renderTokens=function(e,t,n,r,a){for(var o,l,i,c="",s=0,u=e.length;s<u;++s)i=void 0,"#"===(l=(o=e[s])[0])?i=this.renderSection(o,t,n,r,a):"^"===l?i=this.renderInverted(o,t,n,r,a):">"===l?i=this.renderPartial(o,t,n,a):"&"===l?i=this.unescapedValue(o,t):"name"===l?i=this.escapedValue(o,t,a):"text"===l&&(i=this.rawValue(o)),void 0!==i&&(c+=i);return c},Writer.prototype.renderSection=function(e,t,n,r,a){var o=this,l="",i=t.lookup(e[1]);if(i){if(H(i))for(var c=0,s=i.length;c<s;++c)l+=this.renderTokens(e[4],t.push(i[c]),n,r,a);else if("object"==typeof i||"string"==typeof i||"number"==typeof i)l+=this.renderTokens(e[4],t.push(i),n,r,a);else if(U(i)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(i=i.call(t.view,r.slice(e[3],e[5]),(function(e){return o.render(e,t,n,a)})))&&(l+=i)}else l+=this.renderTokens(e[4],t,n,r,a);return l}},Writer.prototype.renderInverted=function(e,t,n,r,a){var o=t.lookup(e[1]);if(!o||H(o)&&0===o.length)return this.renderTokens(e[4],t,n,r,a)},Writer.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),a=e.split("\n"),o=0;o<a.length;o++)a[o].length&&(o>0||!n)&&(a[o]=r+a[o]);return a.join("\n")},Writer.prototype.renderPartial=function(e,t,n,r){if(n){var a=this.getConfigTags(r),o=U(n)?n(e[1]):n[e[1]];if(null!=o){var l=e[6],i=e[5],c=e[4],s=o;0==i&&c&&(s=this.indentPartial(o,c,l));var u=this.parse(s,a);return this.renderTokens(u,t,n,s,r)}}},Writer.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},Writer.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||J.escape,a=t.lookup(e[1]);if(null!=a)return"number"==typeof a&&r===J.escape?String(a):r(a)},Writer.prototype.rawValue=function(e){return e[1]},Writer.prototype.getConfigTags=function(e){return H(e)?e:e&&"object"==typeof e?e.tags:void 0},Writer.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!H(e)?e.escape:void 0};var J={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){Q.templateCache=e},get templateCache(){return Q.templateCache}},Q=new Writer;function Icon({icon:e}){const t=w(e);return t?o.createElement(t,null):e}function X(e,t){return o.createElement(o.Fragment,null,o.createElement(Icon,{icon:t})," ",e)}function useAnalyst(){const e=useAnalystConfig(),[t,n]=useAnalystData(e.url||null,e.data||null),r=useAnalystModes(t,e),[a,o,l]=function useAnalystForm(e){const[t,n]=s(ne),r=c((()=>function(e,t){if(!e)return null;const n=e.find((e=>e.name===t)),r=[{type:e.length>1?"select one":"hidden",name:"mode",label:"",bind:{required:!0},fullwidth:!0,choices:e.map((({name:e,label:t})=>({name:e,label:X(t,e)})))}];n&&n.dateColumns&&n.dateColumns.length>0&&r.push({name:"date",type:n.dateColumns.length>1?"select one":"hidden",label:"Date",control:n.dateColumns.length>1?{appearance:"select"}:null,bind:{required:!0},choices:n.dateColumns.map((e=>({name:e,label:e})))});n&&n.valueColumns&&n.valueColumns.length>0&&(r.push({name:"value",type:n.valueColumns.length>1?"select one":"hidden",control:n.valueColumns.length>1?{appearance:"select"}:null,label:"scatter"===t?"X":"Value",bind:{required:!0},choices:n.valueColumns.map((e=>({name:e,label:e})))}),"scatter"==t&&r.push({name:"value2",type:"select one",control:{appearance:"select"},label:"Y",bind:{required:!0},choices:n.valueColumns.map((e=>({name:e,label:e})))}));"boxplot"===t&&n&&n.dateColumns&&r.push({name:"group",type:"select one",control:{appearance:"select"},label:"Group",bind:{required:!0},choices:[{name:"all",label:"All Data"},{name:"year",label:"Year"},{name:"month",label:"Month"}]});return r}(e,t.mode)),[e,t.mode]);return i((()=>{const e={},a=t||{};for(const t of r)t.choices&&t.choices.length>0&&!a[t.name]?e[t.name]=t.choices["value2"===t.name&&t.choices.length>1?1:0].name:void 0===a[t.name]&&(e[t.name]="");Object.keys(e).length>0&&n({...t,...e})}),[r,t]),[r,t,n]}(r);return{...e,data:t,error:e.error||n||(t?null:"Loading..."),modes:r,form:a,options:o,setOptions:l}}function useAnalystConfig(){const{page_config:{name:e,analyst:t={}}}=x(),n=C();return t.url?{...t,url:K(t.url,n),title:K(t.title,n)}:{error:`The config for "${e}" should include an analyst.url property.`}}function K(e,t){return e?J.render(e,t):e}function useAnalystData(e,t){const[n,r]=s(t),[a,o]=s(null);return i((()=>{e&&async function(){try{const t=await async function(e,t={}){const n=await fetch(e);return D(await n.text(),t)}(e,{flatten:!0});t&&t.length>0?r(t):o("No data found.")}catch(e){console.error(e),o("Error loading data.")}}()}),[e]),i((()=>{r(t)}),[t]),[n,a]}function useAnalystModes(e,t){return c((()=>{const n=[],r=function(e){const t={},n=e&&e.datasets||[{data:e||[]}];for(const e of n)for(const n of e.data)for(const[e,r]of Object.entries(n))ee(r)?t[e]="numeric":te(r)&&"numeric"!==t[e]?t[e]="date":r&&!t[e]&&(t[e]="string");const r={};for(const[e,n]of Object.entries(t))r[n]||(r[n]=[]),r[n].push(e);return r}(e);return(r.date||r.numeric||r.string)&&n.push({name:"table",label:"Table"}),r.date&&r.numeric&&n.push({name:"series",label:"Series",dateColumns:r.date,valueColumns:r.numeric}),r.numeric&&r.numeric.length>1&&n.push({name:"scatter",label:"Scatter",dateColumns:r.date,valueColumns:r.numeric}),r.numeric&&n.push({name:"boxplot",label:"Box",dateColumns:r.date,valueColumns:r.numeric}),t&&t.modes?t.modes.map((e=>n.find((t=>t.name===e)))).filter(Boolean):n}),[e,t])}function ee(e){return"number"==typeof e}function te(e){return e instanceof Date||"string"==typeof e&&e.match(/^\d{4}-\d{2}-\d{2}$/)}J.clearCache=function(){return Q.clearCache()},J.parse=function(e,t){return Q.parse(e,t)},J.render=function(e,t,n,r){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+((H(a=e)?"array":typeof a)+'" was given as the first argument for mustache#render(template, view, partials)'));var a;return Q.render(e,t,n,r)},J.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return $[e]}))},J.Scanner=Scanner,J.Context=Context,J.Writer=Writer,Icon.propTypes={icon:A.string};const ne={mode:"",date:"",value:"",value2:"",group:""};function re(){return re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},re.apply(this,arguments)}function AnalystTable({data:e,url:t,initial_rows:n,initial_order:r,id_column:a,id_url_prefix:u,compact:f}){const[h,m]=useAnalystData(t,e),[d,v]=s(),[g,w]=s({}),[C,x]=s(r||{}),A="all"!==n,[T,j]=s(A?n||50:null),[k,O]=s(0),{Typography:V,Table:z,TableHead:_,TableBody:S,TableRow:F,TableTitle:D,TableCell:M,TableContainer:I,TablePagination:H,IconButton:U}=b(),W=y(),L=E(),B=u&&new URL(u,window.location.origin).toString().startsWith(new URL(W.base_url,window.location.origin).toString()),R=e=>{const t=`${u}${e}`;B?L(t):window.location.href=t};i((()=>{if(!h||0===h.length)return;let e=Object.keys(h[0]),t=new Set(e);for(const n of h){const r=Object.keys(n);r.length>e.length&&(e=r);for(const e of r)t.has(e)||t.add(e)}for(const n of t)e.includes(n)||e.push(n);const n=e.map((e=>{const t={},n={...g};delete n[e],h.datasets.forEach((e=>{ae(e,n)&&Object.entries(e).forEach((([n,r])=>{"data"!==n&&(t[n]||(t[n]={}),t[n][r]=(t[n][r]||0)+e.data.length)}))}));const r={name:e};return t[e]&&(r.values=Object.entries(t[e]).sort(((e,t)=>oe(e[0],t[0]))).map((([e,t])=>({value:e,count:t})))),r}));v(n)}),[h,g]);const P=c((()=>h?0===Object.keys(C).length&&0===Object.keys(g).length?h:h.filter((e=>ae(e,g))).sort(((e,t)=>{let n=0;return Object.entries(C).forEach((([r,a])=>{n||(n=oe(e[r],t[r],a))})),n})):null),[h,g,C]),$=c((()=>P?A?P.slice(k*T,k*T+T):P:null),[P,A,k,T]),N=e=>{let t={...C};C[e]?"asc"===C[e]?t[e]="desc":delete t[e]:t={[e]:"asc",...t},x(t)},q=(e,t)=>{const n={...g};g[e]?n[e].has(t)?(n[e].delete(t),0===n[e].size&&delete n[e]):n[e].add(t):n[e]=new Set([t]),w(n)},G=e=>{const t={...g};delete t[e],w(t)},Y=l((e=>e.name==a?o.createElement(D,null):o.createElement(D,{key:e.name},o.createElement("div",{style:{display:"flex",alignItems:"center",marginLeft:-8,borderLeft:"2px solid #ccc",paddingLeft:8,marginRight:-16}},o.createElement("span",{style:{flex:1,fontWeight:"bold"}},e.name),o.createElement(p,{overlap:"circular",badgeContent:Object.keys(C).indexOf(e.name)+1},o.createElement(U,{size:"small",icon:"desc"===C[e.name]?"sort-desc":C[e.name]?"sort-asc":"sort-none",color:C[e.name]&&"secondary",onClick:()=>N(e.name)})),e.values&&o.createElement(ColumnFilter,re({},e,{filter:g[e.name],toggleFilter:t=>q(e.name,t),resetFilter:()=>G(e.name)}))))),[C,N,g,q,G]),Z=l((e=>e.name===a?null:e.values?o.createElement(D,{style:{cursor:"pointer"}},o.createElement(ColumnFilter,re({},e,{textButton:!0,filter:g[e.name],toggleFilter:t=>q(e.name,t),resetFilter:()=>G(e.name)}))):o.createElement(D,{style:{cursor:"pointer"},onClick:()=>N(e.name)},o.createElement("span",{style:{fontWeight:"bold"}},e.name),"desc"===C[e.name]?" ↓":C[e.name]?" ↑":"")),[g,q,G,C,N]),J=f?Z:Y,Q=l((e=>{if(e.column.name===a)return f?null:o.createElement(M,null,o.createElement(CellLink,re({},e,{nav:R})));if(f&&a){const t=e.row[a];return o.createElement(M,{style:{cursor:"pointer"},onClick:()=>R(t)},o.createElement(CellValue,e))}return o.createElement(M,null,o.createElement(CellValue,e))}),[f,a]);return m?o.createElement(V,null,m):h?d?P.length?o.createElement(o.Fragment,null,o.createElement(I,null,o.createElement(z,{stickyHeader:!0},o.createElement(_,null,o.createElement(F,null,d.map((e=>o.createElement(J,re({key:e.name},e)))))),o.createElement(S,null,$.map(((e,t)=>o.createElement(F,{key:a?e[a]:t},d.map((t=>o.createElement(Q,{key:t.name,column:t,row:e}))))))))),A&&o.createElement(H,{component:"div",style:{minHeight:52},count:P.length,page:k,rowsPerPage:T,onPageChange:(e,t)=>O(t),onRowsPerPageChange:e=>j(e.target.value)})):o.createElement(V,null,"No data matching the current filter(s)."):o.createElement(V,null,"No data."):o.createElement(V,null,"Loading...")}function ColumnFilter({name:e,values:t,filter:n,toggleFilter:r,resetFilter:a,textButton:l}){const[i,c]=s(null),{IconButton:u,CheckboxButton:p}=b(),f=`${e}-menu`,d=l?TextButton:u;return o.createElement(o.Fragment,null,o.createElement(d,{"aria-controls":f,onClick:e=>c(e.target),size:"small",icon:"filter",color:n&&"secondary",title:e}),o.createElement(h,{id:f,anchorEl:i,open:!!i,onClose:()=>c(null)},o.createElement(m,{onClick:a},o.createElement(p,{checked:!n})," All ",e,"s"),t.map((({value:e,count:t})=>o.createElement(m,{key:e,onClick:()=>r(e)},o.createElement(p,{checked:n&&n.has(e)||!1}),e," (",t,")")))))}function TextButton(e){return o.createElement("span",re({},e,{style:{fontWeight:"bold"}}),e.title,e.color&&" *")}function CellValue({row:e,column:t}){const{name:n}=t,r=e[n];return o.createElement(o.Fragment,null,r)}function CellLink({row:e,column:t,nav:n}){const{name:r}=t,a=e[r],{IconButton:l}=b();return o.createElement(l,{icon:"view",size:"small",color:"primary",onClick:()=>n(a),title:`View ${r} ${a}`})}function ae(e,t){let n=!0;return Object.entries(t).forEach((([t,r])=>{r.has(e[t])||(n=!1)})),n}function oe(e,t,n="asc"){return"desc"==n?oe(t,e):void 0!==e&&void 0===t?-1:void 0===e&&void 0!==t?1:e<t?-1:e>t?1:0}AnalystTable.propTypes={data:A.arrayOf(A.object),url:A.string,initial_rows:A.oneOfType([A.number,A.string]),compact:A.bool,initial_order:A.object,id_column:A.string,id_url_prefix:A.string},ColumnFilter.propTypes={name:A.string,values:A.arrayOf(A.object),filter:A.object,toggleFilter:A.func,resetFilter:A.func,textButton:A.bool},TextButton.propTypes={title:A.string,color:A.string},CellValue.propTypes={row:A.object,column:A.object},CellLink.propTypes={row:A.object,column:A.object,nav:A.func};const{formik:le}=e,{Formik:ie}=le,{"@wq/material":ce}=e;ce.default;const{View:se}=ce;function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ue.apply(this,arguments)}function AnalystForm({form:e,options:t,setOptions:n}){return o.createElement(ie,{initialValues:t,enableReinitialize:!0,validate:n},o.createElement(se,{sx:{p:2}},o.createElement(f,{container:!0,spacing:1,sx:{}},e.map((e=>o.createElement(GridInput,ue({key:e.name},e)))))))}function GridInput(e){return"hidden"===e.type?o.createElement(g,e):e.fullwidth?o.createElement(f,{item:!0,xs:12,lg:6,xl:4},o.createElement(g,e)):o.createElement(f,{item:!0,xs:12,md:6,lg:3,xl:2},o.createElement(g,e))}AnalystForm.propTypes={form:A.arrayOf(A.object),options:A.object,setOptions:A.func},GridInput.propTypes={type:A.string,fullwidth:A.bool};var pe=Object.freeze({__proto__:null,AnalystDownload:AnalystDownload,AnalystForm:AnalystForm,AnalystTable:AnalystTable});function Analyst(){const{View:e,Typography:t,AnalystDownload:l,AnalystTable:i,AnalystForm:c}=b(),{url:s,data:u,error:p,title:f,formats:h,initial_rows:m,initial_order:d,id_column:v,id_url_prefix:g,form:y,options:w,setOptions:E}=useAnalyst();return p?o.createElement(e,{sx:{p:2}},o.createElement(t,null,p)):o.createElement(e,{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"}},h&&o.createElement(l,{url:s,title:f,formats:h}),!h&&f&&o.createElement(t,{variant:"h5"},f),y&&o.createElement(c,{form:y,options:w,setOptions:E}),"series"===w.mode&&o.createElement(n,{datasets:u&&u.datasets,x:w.date,y:w.value}),"scatter"===w.mode&&o.createElement(r,{datasets:u&&u.datasets,x:w.value,y:w.value2,label:w.date}),"boxplot"===w.mode&&o.createElement(a,{datasets:u&&u.datasets,x:w.date,y:w.value,group:w.group}),!w.mode||"table"===w.mode&&o.createElement(i,{data:u,initial_rows:m,initial_order:d,id_column:v,id_url_prefix:g}))}var fe=Object.freeze({__proto__:null,Analyst:Analyst});const{"@mui/material/utils":he}=e,{createSvgIcon:me}=he,{"react/jsx-runtime":de}=e,{jsx:ve}=de;var ge=me(ve("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward"),ye=me(ve("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"}),"ArrowUpward"),be=me(ve("path",{d:"M16 17.01V10h-2v7.01h-3L15 21l4-3.99h-3zM9 3 5 6.99h3V14h2V6.99h3L9 3z"}),"SwapVert"),we=me(ve("path",{d:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"}),"FilterList"),Ee=me(ve("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67 2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"}),"SaveAlt"),Ce=me(ve("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"Visibility"),xe=me(ve("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-5h2v5zm4 0h-2v-3h2v3zm0-5h-2v-2h2v2zm4 5h-2V7h2v10z"}),"Analytics"),Ae=me(ve("path",{d:"M19 7H9c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2zm0 2v2H9V9h10zm-6 6v-2h2v2h-2zm2 2v2h-2v-2h2zm-4-2H9v-2h2v2zm6-2h2v2h-2v-2zm-8 4h2v2H9v-2zm8 2v-2h2v2h-2zM6 17H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v1h-2V5H5v10h1v2z"}),"TableView"),Te=me(ve("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2z"}),"Timeline"),je=me([ve("circle",{cx:"7",cy:"14",r:"3"},"0"),ve("circle",{cx:"11",cy:"6",r:"3"},"1"),ve("circle",{cx:"16.6",cy:"17.6",r:"3"},"2")],"ScatterPlot"),ke=me(ve("path",{d:"M9 4H7v2H5v12h2v2h2v-2h2V6H9V4zm0 12H7V8h2v8zm10-8h-2V4h-2v4h-2v7h2v5h2v-5h2V8zm-2 5h-2v-3h2v3z"}),"CandlestickChartOutlined");const Oe={name:"analyst",dependencies:[t],version:"2.0.0a1",components:{...pe},views:{...fe},icons:{...Object.freeze({__proto__:null,Analyst:xe,Boxplot:ke,Download:Ee,Filter:we,Scatter:je,Series:Te,SortAsc:ye,SortDesc:ge,SortNone:be,Table:Ae,View:Ce})}};export{Analyst,AnalystDownload,AnalystForm,AnalystTable,Oe as default,useAnalyst,useAnalystConfig,useAnalystData,useAnalystModes};
//# sourceMappingURL=analyst.js.map
