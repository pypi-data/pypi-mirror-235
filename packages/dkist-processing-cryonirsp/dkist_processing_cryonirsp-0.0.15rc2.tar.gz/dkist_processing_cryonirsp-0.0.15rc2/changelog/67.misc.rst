Complete refactorization of the SP solar gain task.
