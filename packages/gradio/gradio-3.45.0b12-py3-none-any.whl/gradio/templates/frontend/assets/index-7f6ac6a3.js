import*as H from"./svelte/svelte.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();const Ee="modulepreload",$e=function(e,t){return new URL(e,t).href},ae={},ee=function(t,s,o){if(!s||s.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(s.map(r=>{if(r=$e(r,o),r in ae)return;ae[r]=!0;const i=r.endsWith(".css"),d=i?'[rel="stylesheet"]':"";if(!!o)for(let a=n.length-1;a>=0;a--){const g=n[a];if(g.href===r&&(!i||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${d}`))return;const l=document.createElement("link");if(l.rel=i?"stylesheet":Ee,i||(l.as="script",l.crossOrigin=""),l.href=r,document.head.appendChild(l),i)return new Promise((a,g)=>{l.addEventListener("load",a),l.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())};var Y=new Intl.Collator(0,{numeric:1}).compare;function ue(e,t,s){return e=e.split("."),t=t.split("."),Y(e[0],t[0])||Y(e[1],t[1])||(t[2]=t.slice(2).join("."),s=/[.-]/.test(e[2]=e.slice(2).join(".")),s==/[.-]/.test(t[2])?Y(e[2],t[2]):s?-1:1)}function R(e,t,s){return t.startsWith("http://")||t.startsWith("https://")?s?e:t:e+t}function Q(e){if(e.startsWith("http")){const{protocol:t,host:s}=new URL(e);return s.endsWith("hf.space")?{ws_protocol:"wss",host:s,http_protocol:t}:{ws_protocol:t==="https:"?"wss":"ws",http_protocol:t,host:s}}return{ws_protocol:"wss",http_protocol:"https:",host:e}}const me=/^[^\/]*\/[^\/]*$/,Ne=/.*hf\.space\/{0,1}$/;async function Oe(e,t){const s={};t&&(s.Authorization=`Bearer ${t}`);const o=e.trim();if(me.test(o))try{const n=await fetch(`https://huggingface.co/api/spaces/${o}/host`,{headers:s});if(n.status!==200)throw new Error("Space metadata could not be loaded.");const r=(await n.json()).host;return{space_id:e,...Q(r)}}catch(n){throw new Error("Space metadata could not be loaded."+n.message)}if(Ne.test(o)){const{ws_protocol:n,http_protocol:r,host:i}=Q(o);return{space_id:i.replace(".hf.space",""),ws_protocol:n,http_protocol:r,host:i}}return{space_id:!1,...Q(o)}}function Ae(e){let t={};return e.forEach(({api_name:s},o)=>{s&&(t[s]=o)}),t}const Ce=/^(?=[^]*\b[dD]iscussions{0,1}\b)(?=[^]*\b[dD]isabled\b)[^]*$/;async function le(e){try{const s=(await fetch(`https://huggingface.co/api/spaces/${e}/discussions`,{method:"HEAD"})).headers.get("x-error-message");return!(s&&Ce.test(s))}catch{return!1}}const De="This application is too busy. Keep trying!",W="Connection errored out.";let we;function Pe(e,t){return{post_data:s,upload_files:o,client:n,handle_blob:r};async function s(i,d,h){const l={"Content-Type":"application/json"};h&&(l.Authorization=`Bearer ${h}`);try{var a=await e(i,{method:"POST",body:JSON.stringify(d),headers:l})}catch{return[{error:W},500]}return[await a.json(),a.status]}async function o(i,d,h){const l={};h&&(l.Authorization=`Bearer ${h}`);const a=1e3,g=[];for(let E=0;E<d.length;E+=a){const q=d.slice(E,E+a),$=new FormData;q.forEach(k=>{$.append("files",k)});try{var m=await e(`${i}/upload`,{method:"POST",body:$,headers:l})}catch{return{error:W}}const C=await m.json();g.push(...C)}return{files:g}}async function n(i,d={normalise_files:!0}){return new Promise(async h=>{const{status_callback:l,hf_token:a,normalise_files:g}=d,m={predict:ve,submit:oe,view_api:ie,component_server:Se},E=g??!0;if((typeof window>"u"||!("WebSocket"in window))&&!global.Websocket){const c=await ee(()=>import("./wrapper-6f348d45-38be7a64.js"),["./wrapper-6f348d45-38be7a64.js","./__vite-browser-external-b25bb000.js"],import.meta.url);we=(await ee(()=>import("./__vite-browser-external-b25bb000.js"),[],import.meta.url)).Blob,global.WebSocket=c.WebSocket}const{ws_protocol:q,http_protocol:$,host:C,space_id:k}=await Oe(i,a),I=Math.random().toString(36).substring(2),ye={};let p,z={},J=!1;a&&k&&(J=await qe(k,a));async function ne(c){if(p=c,z=Ae(c?.dependencies||[]),p.auth_required)return{config:p,...m};try{U=await ie(p)}catch(b){console.error(`Could not get api details: ${b.message}`)}return{config:p,...m}}let U;async function be(c){if(l&&l(c),c.status==="running")try{p=await ge(e,`${$}//${C}`,a);const b=await ne(p);h(b)}catch(b){console.error(b),l&&l({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"})}}try{p=await ge(e,`${$}//${C}`,a);const c=await ne(p);h(c)}catch(c){console.error(c),k?se(k,me.test(k)?"space_name":"subdomain",be):l&&l({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"})}function ve(c,b,D){let u=!1,O=!1,_;if(typeof c=="number")_=p.dependencies[c];else{const f=c.replace(/^\//,"");_=p.dependencies[z[f]]}if(_.types.continuous)throw new Error("Cannot call predict on this function as it may run forever. Use submit instead");return new Promise((f,L)=>{const P=oe(c,b,D);let T;P.on("data",A=>{O&&(P.destroy(),f(A)),u=!0,T=A}).on("status",A=>{A.stage==="error"&&L(A),A.stage==="complete"&&(O=!0,u&&(P.destroy(),f(T)))})})}function oe(c,b,D){let u,O;if(typeof c=="number")u=c,O=U.unnamed_endpoints[u];else{const w=c.replace(/^\//,"");u=z[w],O=U.named_endpoints[c.trim()]}if(typeof u!="number")throw new Error("There is no endpoint matching that name of fn_index matching that number.");let _;const f=typeof c=="number"?"/predict":c;let L,P=!1;const T={};let A="";typeof window<"u"&&(A=new URLSearchParams(window.location.search).toString()),r(`${$}//${R(C,p.path,!0)}`,b,O,a).then(w=>{if(L={data:w||[],event_data:D,fn_index:u},Be(u,p))N({type:"status",endpoint:f,stage:"pending",queue:!1,fn_index:u,time:new Date}),s(`${$}//${R(C,p.path,!0)}/run${f.startsWith("/")?f:`/${f}`}${A?"?"+A:""}`,{...L,session_hash:I},a).then(([y,v])=>{const S=E?fe(y.data,O,p.root,p.root_url):y.data;v==200?(N({type:"data",endpoint:f,fn_index:u,data:S,time:new Date}),N({type:"status",endpoint:f,fn_index:u,stage:"complete",eta:y.average_duration,queue:!1,time:new Date})):N({type:"status",stage:"error",endpoint:f,fn_index:u,message:y.error,queue:!1,time:new Date})}).catch(y=>{N({type:"status",stage:"error",message:y.message,endpoint:f,fn_index:u,queue:!1,time:new Date})});else{N({type:"status",stage:"pending",queue:!0,endpoint:f,fn_index:u,time:new Date});let y=new URL(`${q}://${R(C,p.path,!0)}
							/queue/join${A?"?"+A:""}`);J&&y.searchParams.set("__sign",J),_=t(y),_.onclose=v=>{v.wasClean||N({type:"status",stage:"error",broken:!0,message:W,queue:!0,endpoint:f,fn_index:u,time:new Date})},_.onmessage=function(v){const S=JSON.parse(v.data),{type:j,status:B,data:F}=ke(S,ye[u]);if(j==="update"&&B&&!P)N({type:"status",endpoint:f,fn_index:u,time:new Date,...B}),B.stage==="error"&&_.close();else if(j==="hash"){_.send(JSON.stringify({fn_index:u,session_hash:I}));return}else j==="data"?_.send(JSON.stringify({...L,session_hash:I})):j==="complete"?P=B:j==="log"?N({type:"log",log:F.log,level:F.level,endpoint:f,fn_index:u}):j==="generating"&&N({type:"status",time:new Date,...B,stage:B?.stage,queue:!0,endpoint:f,fn_index:u});F&&(N({type:"data",time:new Date,data:E?fe(F.data,O,p.root,p.root_url):F.data,endpoint:f,fn_index:u}),P&&(N({type:"status",time:new Date,...P,stage:B?.stage,queue:!0,endpoint:f,fn_index:u}),_.close()))},ue(p.version||"2.0.0","3.6")<0&&addEventListener("open",()=>_.send(JSON.stringify({hash:I})))}});function N(w){const v=T[w.type]||[];v?.forEach(S=>S(w))}function M(w,y){const v=T,S=v[w]||[];return v[w]=S,S?.push(y),{on:M,off:G,cancel:K,destroy:V}}function G(w,y){const v=T;let S=v[w]||[];return S=S?.filter(j=>j!==y),v[w]=S,{on:M,off:G,cancel:K,destroy:V}}async function K(){const w={stage:"complete",queue:!1,time:new Date};P=w,N({...w,type:"status",endpoint:f,fn_index:u}),_&&_.readyState===0?_.addEventListener("open",()=>{_.close()}):_.close();try{await e(`${$}//${R(C,p.path,!0)}/reset`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({fn_index:u,session_hash:I})})}catch{console.warn("The `/reset` endpoint could not be called. Subsequent endpoint results may be unreliable.")}}function V(){for(const w in T)T[w].forEach(y=>{G(w,y)})}return{on:M,off:G,cancel:K,destroy:V}}async function Se(c,b,D){var u;const O={"Content-Type":"application/json"};a&&(O.Authorization=`Bearer ${a}`);let _,f=p.components.find(T=>T.id===c);(u=f?.props)!=null&&u.root_url?_=f.props.root_url:_=`${$}//${R(C,p.path,!0)}/`;const L=await e(`${_}component_server/`,{method:"POST",body:JSON.stringify({data:D,component_id:c,fn_name:b,session_hash:I}),headers:O});if(!L.ok)throw new Error("Could not connect to component server: "+L.statusText);return await L.json()}async function ie(c){if(U)return U;const b={"Content-Type":"application/json"};a&&(b.Authorization=`Bearer ${a}`);let D;if(ue(c.version||"2.0.0","3.30")<0?D=await e("https://gradio-space-api-fetcher-v2.hf.space/api",{method:"POST",body:JSON.stringify({serialize:!1,config:JSON.stringify(c)}),headers:b}):D=await e(`${c.root}/info`,{headers:b}),!D.ok)throw new Error(W);let u=await D.json();return"api"in u&&(u=u.api),u.named_endpoints["/predict"]&&!u.unnamed_endpoints[0]&&(u.unnamed_endpoints[0]=u.named_endpoints["/predict"]),Te(u,c,z)}})}async function r(i,d,h,l){const a=await te(d,void 0,[],!0,h);return Promise.all(a.map(async({path:g,blob:m,data:E,type:q})=>{if(m){const $=(await o(i,[m],l)).files[0];return{path:g,file_url:$,type:q}}return{path:g,base64:E,type:q}})).then(g=>(g.forEach(({path:m,file_url:E,base64:q,type:$})=>{if(q)X(d,q,m);else if($==="Gallery")X(d,E,m);else if(E){const C={is_file:!0,name:`${E}`,data:null};X(d,C,m)}}),d))}}const{post_data:Re,upload_files:ce,client:de,handle_blob:Ue}=Pe(fetch,(...e)=>new WebSocket(...e));function fe(e,t,s,o){return e.map((n,r)=>{var i,d,h,l;return((d=(i=t?.returns)==null?void 0:i[r])==null?void 0:d.component)==="File"?x(n,s,o):((l=(h=t?.returns)==null?void 0:h[r])==null?void 0:l.component)==="Gallery"?n.map(a=>Array.isArray(a)?[x(a[0],s,o),a[1]]:[x(a,s,o),null]):typeof n=="object"&&n?.is_file?x(n,s,o):n})}function x(e,t,s){if(e==null)return null;if(typeof e=="string")return{name:"file_data",data:e};if(Array.isArray(e)){const o=[];for(const n of e)n===null?o.push(null):o.push(x(n,t,s));return o}else e.is_file&&(s?e.data="/proxy="+s+"file="+e.name:e.data=t+"/file="+e.name);return e}function pe(e,t,s,o){switch(e.type){case"string":return"string";case"boolean":return"boolean";case"number":return"number"}if(s==="JSONSerializable"||s==="StringSerializable")return"any";if(s==="ListStringSerializable")return"string[]";if(t==="Image")return o==="parameter"?"Blob | File | Buffer":"string";if(s==="FileSerializable")return e?.type==="array"?o==="parameter"?"(Blob | File | Buffer)[]":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}[]":o==="parameter"?"Blob | File | Buffer":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}";if(s==="GallerySerializable")return o==="parameter"?"[(Blob | File | Buffer), (string | null)][]":"[{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}, (string | null))][]"}function he(e,t){return t==="GallerySerializable"?"array of [file, label] tuples":t==="ListStringSerializable"?"array of strings":t==="FileSerializable"?"array of files or single file":e.description}function Te(e,t,s){const o={named_endpoints:{},unnamed_endpoints:{}};for(const n in e){const r=e[n];for(const i in r){const d=t.dependencies[i]?i:s[i.replace("/","")],h=r[i];o[n][i]={},o[n][i].parameters={},o[n][i].returns={},o[n][i].type=t.dependencies[d].types,o[n][i].parameters=h.parameters.map(({label:l,component:a,type:g,serializer:m})=>({label:l,component:a,type:pe(g,a,m,"parameter"),description:he(g,m)})),o[n][i].returns=h.returns.map(({label:l,component:a,type:g,serializer:m})=>({label:l,component:a,type:pe(g,a,m,"return"),description:he(g,m)}))}}return o}async function qe(e,t){try{return(await(await fetch(`https://huggingface.co/api/spaces/${e}/jwt`,{headers:{Authorization:`Bearer ${t}`}})).json()).token||!1}catch(s){return console.error(s),!1}}function X(e,t,s){for(;s.length>1;)e=e[s.shift()];e[s.shift()]=t}async function te(e,t=void 0,s=[],o=!1,n=void 0){if(Array.isArray(e)){let r=[];return await Promise.all(e.map(async(i,d)=>{var h;let l=s.slice();l.push(d);const a=await te(e[d],o?((h=n?.parameters[d])==null?void 0:h.component)||void 0:t,l,!1,n);r=r.concat(a)})),r}else if(globalThis.Buffer&&e instanceof globalThis.Buffer){const r=t==="Image";return[{path:s,blob:r?!1:new we([e]),data:r?`${e.toString("base64")}`:!1,type:t}]}else if(e instanceof Blob||typeof window<"u"&&e instanceof File){if(t==="Image"){let r;if(typeof window<"u")r=await Le(e);else{const i=await e.arrayBuffer();r=Buffer.from(i).toString("base64")}return[{path:s,data:r,type:t,blob:!1}]}return[{path:s,blob:e,type:t,data:!1}]}else if(typeof e=="object"){let r=[];for(let i in e)if(e.hasOwnProperty(i)){let d=s.slice();d.push(i),r=r.concat(await te(e[i],void 0,d,!1,n))}return r}return[]}function Le(e){return new Promise((t,s)=>{const o=new FileReader;o.onloadend=()=>t(o.result),o.readAsDataURL(e)})}function Be(e,t){var s,o,n,r;return!(((o=(s=t?.dependencies)==null?void 0:s[e])==null?void 0:o.queue)===null?t.enable_queue:(r=(n=t?.dependencies)==null?void 0:n[e])!=null&&r.queue)||!1}async function ge(e,t,s){const o={};if(s&&(o.Authorization=`Bearer ${s}`),typeof window<"u"&&window.gradio_config&&location.origin!=="http://localhost:9876"&&!window.gradio_config.dev_mode){const n=window.gradio_config.root,r=window.gradio_config;return r.root=R(t,r.root,!1),{...r,path:n}}else if(t){let n=await e(`${t}/config`,{headers:o});if(n.status===200){const r=await n.json();return r.path=r.path??"",r.root=t,r}throw new Error("Could not get config.")}throw new Error("No config or app endpoint found")}async function se(e,t,s){let o=t==="subdomain"?`https://huggingface.co/api/spaces/by-subdomain/${e}`:`https://huggingface.co/api/spaces/${e}`,n,r;try{if(n=await fetch(o),r=n.status,r!==200)throw new Error;n=await n.json()}catch{s({status:"error",load_status:"error",message:"Could not get space status",detail:"NOT_FOUND"});return}if(!n||r!==200)return;const{runtime:{stage:i},id:d}=n;switch(i){case"STOPPED":case"SLEEPING":s({status:"sleeping",load_status:"pending",message:"Space is asleep. Waking it up...",detail:i}),setTimeout(()=>{se(e,t,s)},1e3);break;case"PAUSED":s({status:"paused",load_status:"error",message:"This space has been paused by the author. If you would like to try this demo, consider duplicating the space.",detail:i,discussions_enabled:await le(d)});break;case"RUNNING":case"RUNNING_BUILDING":s({status:"running",load_status:"complete",message:"",detail:i});break;case"BUILDING":s({status:"building",load_status:"pending",message:"Space is building...",detail:i}),setTimeout(()=>{se(e,t,s)},1e3);break;default:s({status:"space_error",load_status:"error",message:"This space is experiencing an issue.",detail:i,discussions_enabled:await le(d)});break}}function ke(e,t){switch(e.msg){case"send_data":return{type:"data"};case"send_hash":return{type:"hash"};case"queue_full":return{type:"update",status:{queue:!0,message:De,stage:"error",code:e.code,success:e.success}};case"estimation":return{type:"update",status:{queue:!0,stage:t||"pending",code:e.code,size:e.queue_size,position:e.rank,eta:e.rank_eta,success:e.success}};case"progress":return{type:"update",status:{queue:!0,stage:"pending",code:e.code,progress_data:e.progress_data,success:e.success}};case"log":return{type:"log",data:e};case"process_generating":return{type:"generating",status:{queue:!0,message:e.success?null:e.output.error,stage:e.success?"generating":"error",code:e.code,progress_data:e.progress_data,eta:e.average_duration},data:e.success?e.output:null};case"process_completed":return"error"in e.output?{type:"update",status:{queue:!0,message:e.output.error,stage:"error",code:e.code,success:e.success}}:{type:"complete",status:{queue:!0,message:e.success?void 0:e.output.error,stage:e.success?"complete":"error",code:e.code,progress_data:e.progress_data,eta:e.output.average_duration},data:e.success?e.output:null};case"process_starts":return{type:"update",status:{queue:!0,stage:"pending",code:e.code,size:e.rank,position:0,success:e.success}}}return{type:"none",status:{stage:"error",queue:!0}}}function _e(e,t){if(document.querySelector(`link[href='${e}']`))return Promise.resolve();const o=document.createElement("link");return o.rel="stylesheet",o.href=e,new Promise((n,r)=>{o.addEventListener("load",()=>n()),o.addEventListener("error",()=>{console.error(`Unable to preload CSS for ${e}`),n()}),t.appendChild(o)})}const je="./assets/index-9a82ef44.css";let re;re=[];let Z;function Ie(){const e={SvelteComponent:H.SvelteComponent};for(const s in H)s!=="SvelteComponent"&&(s==="SvelteComponentDev"?e[s]=e.SvelteComponent:e[s]=H[s]);window.__gradio__svelte__internal=e;class t extends HTMLElement{constructor(){super(),this.host=this.getAttribute("host"),this.space=this.getAttribute("space"),this.src=this.getAttribute("src"),this.control_page_title=this.getAttribute("control_page_title"),this.initial_height=this.getAttribute("initial_height")??"300px",this.is_embed=this.getAttribute("embed")??"true",this.container=this.getAttribute("container")??"true",this.info=this.getAttribute("info")??!0,this.autoscroll=this.getAttribute("autoscroll"),this.eager=this.getAttribute("eager"),this.theme_mode=this.getAttribute("theme_mode"),this.updating=!1,this.loading=!1}async connectedCallback(){Z=(await ee(()=>import("./Index-53af0ba0.js").then(r=>r.I),["./Index-53af0ba0.js","./Index-c0b3bcca.css"],import.meta.url)).default,this.loading=!0,this.app&&this.app.$destroy(),typeof re!="string"&&re.forEach(r=>_e(r,document.head)),await _e(je,document.head);const o=new CustomEvent("domchange",{bubbles:!0,cancelable:!1,composed:!0});new MutationObserver(r=>{this.dispatchEvent(o)}).observe(this,{childList:!0}),this.app=new Z({target:this,props:{space:this.space?this.space.trim():this.space,src:this.src?this.src.trim():this.src,host:this.host?this.host.trim():this.host,info:this.info!=="false",container:this.container!=="false",is_embed:this.is_embed!=="false",initial_height:this.initial_height,eager:this.eager==="true",version:"3-45-0-beta-12",theme_mode:this.theme_mode,autoscroll:this.autoscroll==="true",control_page_title:this.control_page_title==="true",client:de,upload_files:ce,app_mode:window.__gradio_mode__==="app"}}),this.updating&&this.setAttribute(this.updating.name,this.updating.value),this.loading=!1}static get observedAttributes(){return["src","space","host"]}attributeChangedCallback(o,n,r){if((o==="host"||o==="space"||o==="src")&&r!==n){if(this.updating={name:o,value:r},this.loading)return;this.app&&this.app.$destroy(),this.space=null,this.host=null,this.src=null,o==="host"?this.host=r:o==="space"?this.space=r:o==="src"&&(this.src=r),this.app=new Z({target:this,props:{space:this.space?this.space.trim():this.space,src:this.src?this.src.trim():this.src,host:this.host?this.host.trim():this.host,info:this.info!=="false",container:this.container!=="false",is_embed:this.is_embed!=="false",initial_height:this.initial_height,eager:this.eager==="true",version:"3-45-0-beta-12",theme_mode:this.theme_mode,autoscroll:this.autoscroll==="true",control_page_title:this.control_page_title==="true",client:de,upload_files:ce,app_mode:window.__gradio_mode__==="app"}}),this.updating=!1}}}customElements.get("gradio-app")||customElements.define("gradio-app",t)}Ie();export{ee as _,_e as m,ce as u};
//# sourceMappingURL=index-7f6ac6a3.js.map
