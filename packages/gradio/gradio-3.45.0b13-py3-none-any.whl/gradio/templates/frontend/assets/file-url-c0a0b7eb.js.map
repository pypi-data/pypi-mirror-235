{"version":3,"file":"file-url-c0a0b7eb.js","sources":["../../../../js/wasm/svelte/file-url.ts"],"sourcesContent":["import { getWorkerProxyContext } from \"./context\";\n\ntype MediaSrc = string | undefined | null;\n\nexport async function resolve_wasm_src(src: MediaSrc): Promise<MediaSrc> {\n\tif (src == null) {\n\t\treturn src;\n\t}\n\n\tconst url = new URL(src);\n\tif (\n\t\turl.host !== window.location.host &&\n\t\turl.host !== \"localhost:7860\" &&\n\t\turl.host !== \"127.0.0.1:7860\" // Ref: https://github.com/gradio-app/gradio/blob/v3.32.0/js/app/src/Index.svelte#L194\n\t) {\n\t\t// `src` is not accessing a local server resource, so we don't need to proxy this request to the Wasm worker.\n\t\treturn src;\n\t}\n\tif (url.protocol !== \"http:\" && url.protocol !== \"https:\") {\n\t\t// `src` can be a data URL.\n\t\treturn src;\n\t}\n\n\tconst maybeWorkerProxy = getWorkerProxyContext();\n\tif (maybeWorkerProxy == null) {\n\t\t// We are not in the Wasm env. Just use the src as is.\n\t\treturn src;\n\t}\n\n\tconst path = url.pathname;\n\treturn maybeWorkerProxy\n\t\t.httpRequest({\n\t\t\tmethod: \"GET\",\n\t\t\tpath,\n\t\t\theaders: {},\n\t\t\tquery_string: \"\"\n\t\t})\n\t\t.then((response) => {\n\t\t\tif (response.status !== 200) {\n\t\t\t\tthrow new Error(`Failed to get file ${path} from the Wasm worker.`);\n\t\t\t}\n\t\t\tconst blob = new Blob([response.body], {\n\t\t\t\ttype: response.headers[\"Content-Type\"]\n\t\t\t});\n\t\t\tconst blobUrl = URL.createObjectURL(blob);\n\t\t\treturn blobUrl;\n\t\t});\n}\n"],"names":["resolve_wasm_src","src","url","maybeWorkerProxy","getWorkerProxyContext","path","response","blob"],"mappings":"wCAIA,eAAsBA,EAAiBC,EAAkC,CACxE,GAAIA,GAAO,KACH,OAAAA,EAGF,MAAAC,EAAM,IAAI,IAAID,CAAG,EASvB,GAPCC,EAAI,OAAS,OAAO,SAAS,MAC7BA,EAAI,OAAS,kBACbA,EAAI,OAAS,kBAKVA,EAAI,WAAa,SAAWA,EAAI,WAAa,SAEzC,OAAAD,EAGR,MAAME,EAAmBC,IACzB,GAAID,GAAoB,KAEhB,OAAAF,EAGR,MAAMI,EAAOH,EAAI,SACjB,OAAOC,EACL,YAAY,CACZ,OAAQ,MACR,KAAAE,EACA,QAAS,CAAC,EACV,aAAc,EAAA,CACd,EACA,KAAMC,GAAa,CACf,GAAAA,EAAS,SAAW,IACjB,MAAA,IAAI,MAAM,sBAAsBD,yBAA4B,EAEnE,MAAME,EAAO,IAAI,KAAK,CAACD,EAAS,IAAI,EAAG,CACtC,KAAMA,EAAS,QAAQ,cAAc,CAAA,CACrC,EAEM,OADS,IAAI,gBAAgBC,CAAI,CACjC,CACP,CACH"}